var m=/^(GTM|G)-[0-9A-Z]+$/;function s(r){if(typeof r!="string"||!m.test(r)){let t=String(r).toUpperCase().replace(/.*-|[^0-9A-Z]/g,""),a=t.length===0?"":` Did you mean 'GTM-${t}' or 'G-${t}'?`;throw new Error(`'${r}' is not a valid GTM-ID (${m}).${a}`)}}function n(r,t="dataLayer"){return r[t]||(r[t]=[]),r[t]}function p(r,t){let a=document,e=a.createElement("script"),o=g=>{t.onReady?.({id:r,script:e}),e.removeEventListener("load",o)};e.addEventListener("load",o);let i=t.dataLayerName??"dataLayer";if(n(window,i).push({event:"gtm.js","gtm.start":new Date().getTime()}),!r)return e;e.async=!t.defer,e.defer=!!(t.defer||t.compatibility),t.nonce&&e.setAttribute("nonce",t.nonce),t.scriptType&&(e.type=t.scriptType);let c=new URLSearchParams({id:r,...t.dataLayerName?{l:t.dataLayerName}:{},...t.queryParams??{}}),d=t.source??"https://www.googletagmanager.com/gtm.js";e.src=`${d}?${c}`;let l=t.parentElement??a.body;if(typeof l?.appendChild!="function")throw new Error("parentElement must be a DOM element");return l.appendChild(e),e}function y(r="https://www.googletagmanager.com/gtm.js"){return Array.from(document.getElementsByTagName("script")).some(t=>t.src.includes(r))}var u=class{id;options;scriptElements=[];constructor(t){if(Array.isArray(t.id))for(let a of t.id)typeof a=="string"?s(a):s(a.id);else s(t.id);this.id=t.id,this.options={enabled:!0,debug:!1,loadScript:!0,defer:!1,compatibility:!1,dataLayerName:"dataLayer",...t},delete this.options.id}isInBrowserContext=()=>typeof window<"u";enabled(){return this.options.enabled??!0}enable(t=!0,a){if(this.options.enabled=t,this.isInBrowserContext()&&t&&!y(a)&&this.options.loadScript)if(Array.isArray(this.id))this.id.forEach(e=>{let o;typeof e=="string"?o=p(e,{...this.options}):o=p(e.id,{...this.options,queryParams:e.queryParams}),this.scriptElements.push(o)});else{let e=p(this.id,{...this.options});this.scriptElements.push(e)}}debugEnabled(){return this.options.debug??!1}debug(t){this.options.debug=t}dataLayer(){return this.isInBrowserContext()&&this.options.enabled?n(window,this.options.dataLayerName):!1}trackView(t,a,e={}){let o=this.isInBrowserContext()&&(this.options.enabled??!1);this.options.debug&&console.log(`[GTM-Support${o?"":"(disabled)"}]: Dispatching TrackView`,{screenName:t,path:a}),o&&n(window,this.options.dataLayerName).push({...e,event:this.options.trackViewEventProperty??"content-view","content-name":a,"content-view-name":t})}trackEvent({event:t,category:a=null,action:e=null,label:o=null,value:i=null,noninteraction:b=!1,...c}={}){let d=this.isInBrowserContext()&&(this.options.enabled??!1);this.options.debug&&console.log(`[GTM-Support${d?"":"(disabled)"}]: Dispatching event`,{event:t,category:a,action:e,label:o,value:i,...c}),d&&n(window,this.options.dataLayerName).push({event:t??"interaction",target:a,action:e,"target-properties":o,value:i,"interaction-type":b,...c})}push(t){let a=this.isInBrowserContext()&&(this.options.enabled??!1);this.options.debug&&console.log(`[GTM-Support${a?"":"(disabled)"}]: Dispatching event`,t),a&&n(window,this.options.dataLayerName).push(t)}};export{m as GTM_ID_PATTERN,u as GtmSupport,s as assertIsGtmId,y as hasScript,p as loadScript};
//# sourceMappingURL=index.js.map