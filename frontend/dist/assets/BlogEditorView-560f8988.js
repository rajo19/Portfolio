import{_ as E,B as M,a1 as z,C as $,r as p,o as F,b as g,c as V,w as t,V as q,d as b,e as a,H as I,I as L,h as i,y as w,J as x,i as n,v as y,z as N,Y as R,O as D,D as T,a2 as H,g as u,a3 as S,s as k,Z as O,T as j}from"./index-41a66bf6.js";import{m as J,p as W}from"./purify.es-9335d613.js";const Y={class:"d-flex align-center mb-2"},Z=["innerHTML"],A={class:"d-flex justify-space-between"},G={__name:"BlogEditorView",setup(K){const v=M(),c=z(),d=$(()=>!!v.params.id),m=p(!1),f=p("edit"),r=p(!1),s=p({title:"",content:"",tags:[],image:"",published:!0}),_=o=>{if(!o)return"";const e=J.parse(o);return W.sanitize(e)},C=async()=>{if(m.value){r.value=!0;try{d.value?await b.put(`/api/blog/${v.params.id}`,s.value):await b.post("/api/blog",s.value),c.push({name:"blog"})}catch(o){console.error("Error saving post:",o)}finally{r.value=!1}}},B=async()=>{if(d.value)try{const o=await b.get(`/api/blog/${v.params.id}`),{title:e,content:l,tags:P,image:U}=o.data;s.value={title:e,content:l,tags:[...P||[]],image:U||""}}catch(o){console.error("Error fetching post:",o),c.push({name:"blog"})}};return F(()=>{B()}),(o,e)=>(g(),V(q,{class:"blog-editor"},{default:t(()=>[a(k,null,{default:t(()=>[a(I,{color:"primary",dark:""},{default:t(()=>[a(L,null,{default:t(()=>[i(w(d.value?"Edit Post":"New Post"),1)]),_:1}),a(x),a(n,{icon:"",onClick:e[0]||(e[0]=l=>o.$router.go(-1))},{default:t(()=>[a(y,null,{default:t(()=>[...e[8]||(e[8]=[i("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),a(N,{class:"pa-6"},{default:t(()=>[a(R,{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=l=>m.value=l),onSubmit:D(C,["prevent"])},{default:t(()=>[a(T,{modelValue:s.value.title,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.title=l),label:"Title",variant:"outlined",rules:[l=>!!l||"Title is required"],class:"mb-4",required:""},null,8,["modelValue","rules"]),a(T,{modelValue:s.value.image,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.image=l),label:"Featured Image URL",variant:"outlined",class:"mb-4",hint:"Optional. URL of the featured image","persistent-hint":""},null,8,["modelValue"]),a(H,{modelValue:s.value.tags,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.tags=l),label:"Tags",variant:"outlined",multiple:"",chips:"","closable-chips":"",class:"mb-4",hint:"Press enter or comma to add a tag","persistent-hint":""},null,8,["modelValue"]),u("div",Y,[e[13]||(e[13]=u("label",{class:"text-subtitle-2 font-weight-medium"},"Content",-1)),a(x),a(S,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=l=>f.value=l),mandatory:"",density:"compact",variant:"outlined"},{default:t(()=>[a(n,{value:"edit",size:"small"},{default:t(()=>[a(y,{size:"small",class:"mr-1"},{default:t(()=>[...e[9]||(e[9]=[i("mdi-pencil",-1)])]),_:1}),e[10]||(e[10]=i(" Edit ",-1))]),_:1}),a(n,{value:"preview",size:"small"},{default:t(()=>[a(y,{size:"small",class:"mr-1"},{default:t(()=>[...e[11]||(e[11]=[i("mdi-eye",-1)])]),_:1}),e[12]||(e[12]=i(" Preview ",-1))]),_:1})]),_:1},8,["modelValue"])]),f.value==="preview"?(g(),V(k,{key:0,variant:"outlined",class:"mb-4 pa-4",style:{"min-height":"300px"}},{default:t(()=>[u("div",{class:"markdown-preview",innerHTML:_(s.value.content)},null,8,Z)]),_:1})):(g(),V(O,{key:1,modelValue:s.value.content,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.content=l),label:"Write your post in Markdown",variant:"outlined",rules:[l=>!!l||"Content is required"],rows:"15","auto-grow":"",class:"mb-4",required:""},null,8,["modelValue","rules"])),a(j,{class:"my-4"}),u("div",A,[a(n,{color:"secondary",variant:"text",onClick:e[6]||(e[6]=l=>o.$router.go(-1)),disabled:r.value},{default:t(()=>[...e[14]||(e[14]=[i(" Cancel ",-1)])]),_:1},8,["disabled"]),u("div",null,[a(n,{color:"primary",type:"submit",loading:r.value,disabled:!m.value||r.value},{default:t(()=>[i(w(d.value?"Update Post":"Publish Post"),1)]),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},h=E(G,[["__scopeId","data-v-0d0206c3"]]);export{h as default};
